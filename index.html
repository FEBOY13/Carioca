function comecarImportacao() {
  const lista = document.getElementById('listaContatos');
  lista.innerHTML = '';
  contatosGlobais.forEach((c, i) => {
    const nome = c["Nome"] || "Sem Nome";

    const numeroOriginal = c["Fone Atual"] || '';
    // Remove tudo que não for número para garantir o formato correto
    const numeroFormatado = numeroOriginal.toString().replace(/\D/g, '');

    const mensagem = mensagemPadrao.includes('{nome}')
      ? mensagemPadrao.replace('{nome}', nome)
      : `Olá ${nome}, ${mensagemPadrao}`;

    // Link usando wa.me, que é mais simples e oficial
    const linkWhatsapp = `https://wa.me/${numeroFormatado}?text=${encodeURIComponent(mensagem)}`;

    const contatoDiv = document.createElement("div");
    contatoDiv.className = "contato";
    contatoDiv.id = `contato-${i}`;

    let detalhesHtml = Object.entries(c).map(
      ([chave, valor]) => `<div><strong>${chave}:</strong> ${valor}</div>`
    ).join('');

    detalhesHtml += `
      <a href="${linkWhatsapp}" target="_blank" rel="noopener noreferrer">
        <button class="btn">Enviar mensagem</button>
      </a>
    `;

    detalhesHtml += `
      <button class="btn" onclick="copiarInfo(${i})">Copiar</button>
      <button class="resultado-btn verde" onclick="setResultado(${i}, 'SUCESSO')"></button>
      <button class="resultado-btn amarelo" onclick="setResultado(${i}, 'Podemos tentar novamente')"></button>
      <button class="resultado-btn vermelho" onclick="setResultado(${i}, 'KIKADO')"></button>
    `;

    contatoDiv.innerHTML = `
      <div class="nome">
        ${nome}
        <button class="icone" onclick="toggleDetalhes(${i})">👁️</button>
      </div>
      <div class="detalhes" id="detalhes-${i}">${detalhesHtml}</div>
    `;

    lista.appendChild(contatoDiv);
    contatosGlobais[i]['Resultado'] = '';
  });
}
